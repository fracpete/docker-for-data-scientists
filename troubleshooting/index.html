<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://www.data-mining.co.nz/docker-for-data-scientists/troubleshooting/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Troubleshooting - Docker for Data Scientists</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Troubleshooting";
        var mkdocs_page_input_path = "troubleshooting.md";
        var mkdocs_page_url = "/docker-for-data-scientists/troubleshooting/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Docker for Data Scientists
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../basics/">Basics</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../repos/">Repositories</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../dockerfile/">Dockerfile</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../best_practices/">Best practices</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../tips_and_tricks/">Tips & Tricks</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Troubleshooting</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../automation/">Automation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../registry/">Registry</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Docker for Data Scientists</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Troubleshooting</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/waikato-datamining/docker-for-data-scientists/edit/main/docs/troubleshooting.md"
          class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="cuda-not-available-at-build-time">CUDA not available at build time<a class="headerlink" href="#cuda-not-available-at-build-time" title="Permanent link">#</a></h2>
<p>Some deep learning libraries refuse to get installed if there is no CUDA-capable
device available. Of course, you can fix this by defining a <a href="../tips_and_tricks/#default-runtime">default runtime</a>
in your docker configuration. However, this is not an option when your build 
system does not even have a GPU.</p>
<p>Therefore, an alternative is to skip the CUDA device check by inserting the
<code>FORCE_CUDA</code> environment variable in your docker build as follows: </p>
<pre><code>ENV FORCE_CUDA=&quot;1&quot;
</code></pre>
<h2 id="cuda-architectures-for-pytorch">CUDA architectures for PyTorch<a class="headerlink" href="#cuda-architectures-for-pytorch" title="Permanent link">#</a></h2>
<p>If your container needs to build PyTorch (e.g., if you cannot use a PyTorch base image),
then you can supply the list of <a href="https://docs.nvidia.com/deploy/cuda-compatibility/index.html#support-hardware__table-hardware-support">NVIDIA architectures</a>
via the <code>TORCH_CUDA_ARCH_LIST</code> environment variable. By using <code>ARG</code>, you can define a 
default value and still override it at build time via the <code>--build-arg</code> option:</p>
<pre><code>ARG TORCH_CUDA_ARCH_LIST=&quot;Kepler;Kepler+Tesla;Maxwell;Maxwell+Tegra;Pascal;Volta;Turing&quot;
ENV TORCH_CUDA_ARCH_LIST=&quot;${TORCH_CUDA_ARCH_LIST}&quot;
</code></pre>
<h2 id="interactive-timezone-prompt">Interactive timezone prompt<a class="headerlink" href="#interactive-timezone-prompt" title="Permanent link">#</a></h2>
<p>In case you get the following prompt for configuring your timezone data (which will
fail unattended builds):</p>
<pre><code>Configuring tzdata
------------------

Please select the geographic area in which you live. Subsequent configuration
questions will narrow this down by presenting a list of cities, representing
the time zones in which they are located.

 1. Africa      4. Australia  7. Atlantic  10. Pacific  13. Etc
 2. America     5. Arctic     8. Europe    11. SystemV
 3. Antarctica  6. Asia       9. Indian    12. US
Geographic area:
</code></pre>
<p>Then you can precede your command with <code>DEBIAN_FRONTEND=noninteractive</code>.</p>
<p>In case of <code>apt-get</code>, use something like this:</p>
<pre><code class="language-commandline">RUN DEBIAN_FRONTEND=noninteractive apt-get install -y ...
</code></pre>
<p>Or like this:</p>
<pre><code class="language-commandline">RUN export DEBIAN_FRONTEND=noninteractive &amp;&amp; \
    apt-get install -y ...
</code></pre>
<p>Finally, the brute force method is to define it globally via the <code>ENV</code> command:</p>
<pre><code class="language-commandline">ENV DEBIAN_FRONTEND noninteractive
</code></pre>
<h2 id="missing-shared-library">Missing shared library<a class="headerlink" href="#missing-shared-library" title="Permanent link">#</a></h2>
<p>A common error that you will encounter is installations via <code>pip</code> failing due to a shared
library not being present, similar to this:</p>
<pre><code>error: XYZ.so: cannot open shared object file: No such file or directory
</code></pre>
<p>In order to remedy the problem, you need to determine the package that contains this
shared library. In case of Ubuntu (or Debian) you can use the <em>Ubuntu Packages Search</em>:</p>
<p><a href="https://packages.ubuntu.com/">https://packages.ubuntu.com/</a></p>
<p>On that page, scroll to the <em>Search the contents of packages</em> section and enter
the file name of the missing shared library (e.g., <code>XYZ.so</code>). If you know the
distribution (e.g., <code>bionic</code> release) and architecture (e.g., <code>amd64</code>) then
you can restrict the search further. Finally, click on <em>Search</em>. </p>
<p>From the results page, select the appropriate package name and include that in your 
docker build.</p>
<h2 id="repository-httpsdeveloperdownloadnvidiacomcomputecuda-is-not-signed">Repository 'https://developer.download.nvidia.com/compute/cuda/...' is not signed<a class="headerlink" href="#repository-httpsdeveloperdownloadnvidiacomcomputecuda-is-not-signed" title="Permanent link">#</a></h2>
<p>If installing NVIDIA packages fails (e.g., within Docker) with the following (or similar) error:</p>
<pre><code>The repository 'https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64 InRelease' is not signed.
</code></pre>
<p>This is due to NVIDIA updating/rotating their GPG keys.</p>
<p>Instructions for fixing this error can be found on their developer blog:</p>
<p><a href="https://developer.nvidia.com/blog/updating-the-cuda-linux-gpg-repository-key/">https://developer.nvidia.com/blog/updating-the-cuda-linux-gpg-repository-key/</a></p>
<h2 id="runtimeerror-cannot-cache-function-__shear_dense-no-locator-available-for-file">RuntimeError: cannot cache function '__shear_dense': no locator available for file...<a class="headerlink" href="#runtimeerror-cannot-cache-function-__shear_dense-no-locator-available-for-file" title="Permanent link">#</a></h2>
<p>This error occurs when numba has no access to a writable cache directory (<a href="https://stackoverflow.com/a/63367171/4698227">source</a>). To fix this, make sure that you point the <code>NUMBA_CACHE_DIR</code> at a directory with write access, e.g.:</p>
<pre><code>ENV NUMBA_CACHE_DIR /tmp
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../tips_and_tricks/" class="btn btn-neutral float-left" title="Tips & Tricks"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../automation/" class="btn btn-neutral float-right" title="Automation">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/waikato-datamining/docker-for-data-scientists" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../tips_and_tricks/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../automation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
